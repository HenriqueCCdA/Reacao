#include<NasaPol.h>


/*********************************************************************
 * Data de criacao    : 31/05/2019                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * nasaPolRange: Indentifica o renge do pol da nasa                  *
 *-------------------------------------------------------------------*
 * Parametros de entrada:                                            *
 *-------------------------------------------------------------------*
 * a   -> polinomio                                                  *
 * x   -> valor desejado                                             *
 * c   -> nao definido                                               *
 * xNew-> nao definido                                               *
 *-------------------------------------------------------------------*
 * Parametros de saida:                                              *
 *-------------------------------------------------------------------*
 * c   -> coeficientes dp pol                                        *
 * xNew-> caso esteja fora do range xNew=xMin ou xNew=xMax           *
 *-------------------------------------------------------------------*
 * OBS:                                                              *
 *-------------------------------------------------------------------*
 *********************************************************************/
void nasaPolRange(PolNasa *a      , DOUBLE const x
                 ,DOUBLE **c      , DOUBLE *xNew
                 ,short const iCod)
{
/*... */  
  if(iCod == 1)
  {
    *xNew = x;
    if( a->range[0][0] <= x && x <= a->range[0][1] )
      *c = a->a2[0];
    else if( a->range[1][0] < x && x <= a->range[1][1] )
      *c = a->a2[1];
    else
    {
      if( x < a->range[0][0])
      { 
        *xNew = a->range[0][0]; 
        *c    = a->a2[0];
      }
      if( a->range[1][1] < x)
      {
        *xNew = a->range[1][1]; 
        *c    = a->a2[1]; 
      }
//    fprintf(fileLogDebug,"NasaPol fora do limites %lf!!\n",x);
    }
/*..................................................................*/
  }
/*..................................................................*/

/*... */  
  else if(iCod == 2)
  {
    *xNew = x;
    if( a->range[0][0] <= x && x <= a->range[0][1] )
      *c = a->a1[0];
    else if( a->range[1][0] < x && x <= a->range[1][1] )
      *c = a->a1[1];
    else
    {
      if( x < a->range[0][0])
      { 
        *xNew = a->range[0][0]; 
        *c    = a->a1[0];
      }
      if( a->range[1][1] < x)
      {
        *xNew = a->range[1][1]; 
        *c    = a->a1[1]; 
      }
//    fprintf(fileLogDebug,"NasaPol fora do limites %lf!!\n",x);
    }
/*..................................................................*/
  }
/*..................................................................*/
}
/********************************************************************/

/*********************************************************************
 * Data de criacao    : 31/05/2019                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * polNasaCp:                                                        *
 *-------------------------------------------------------------------*
 * Parametros de entrada:                                            *
 *-------------------------------------------------------------------*
 * x  -> temperatura                                                 *   
 * R  -> constante dos gases ideias                                  *
 * mW -> massa molar                                                 *
 *-------------------------------------------------------------------*
 * Parametros de saida:                                              *
 *-------------------------------------------------------------------*
 * cP em KJ/KGK                                                      *
 *-------------------------------------------------------------------*
 * OBS:                                                              *
 * nasa7                                                             *
 * cP(T)/R = a0 + a1T + a2T^2 + a3T^3 + a4T^4                        *
 * nasa9                                                             *
 * cP(T)/R = a0T^-2 + a1T^-1 + a2 + a3T + a4T^2 + a5T^3 + a6T^4      *                 *
 *-------------------------------------------------------------------*
 *********************************************************************/
DOUBLE polNasaCp(PolNasa *a     , DOUBLE const x)
{

  DOUBLE sum,*c=NULL,xi;

  nasaPolRange(a,x,&c,&xi,1);

  if (a->type == 7)
    sum = c[0] + c[1]*xi + c[2]*xi*xi + c[3]*xi*xi*xi + c[4]*xi*xi*xi*xi;

  return sum;
}
/********************************************************************/

/*********************************************************************
 * Data de criacao    : 31/05/2019                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * polNasaH:                                                         *
 *-------------------------------------------------------------------*
 * Parametros de entrada:                                            *
 *-------------------------------------------------------------------*
 * x  -> temperatura                                                 *   
 * R  -> constante dos gases ideias                                  *
 * mW -> massa molar                                                 *
 *-------------------------------------------------------------------*
 * Parametros de saida:                                              *
 *-------------------------------------------------------------------*
 * H em KJ/KMOL                                                      *
 *-------------------------------------------------------------------*
 * OBS:                                                              *
 * nasa7                                                             *
 * H0(T)/RT = a0 + a1/2T + a2/3T^2 + a3/4T^3 + a4/5T^4 + a5/T        *
 * nasa9                                                             *
 * H0(T)/RT = -a0/2T^-2 - a1T^-1 + a2lnT + a3T + a4/2T^2 + a5/3T^3   * 
 *        + a6/4T^4 +a8                                              *
 *-------------------------------------------------------------------*
 *********************************************************************/
DOUBLE polNasaH(PolNasa *a     , DOUBLE const x, bool const fKelvin)
{

  DOUBLE sum,*c=NULL,xi,r,tc;

  if(fKelvin)
    tc = x;  
  else
    tc = CELSIUS_FOR_KELVIN(x);

/*KJ/(Kmol Kelvin) */
  r = 8.3144621;

  nasaPolRange(a,tc,&c,&xi,2);

  if (a->type == 7)
    sum = c[0]                 + 0.5e0*c[1]*xi
        + c[2]*xi*xi/3.e0      + 0.25e0*c[3]*xi*xi*xi 
        + c[4]*xi*xi*xi*xi/5.e0+ c[5]/xi;

  return r*xi*sum;
}
/********************************************************************/
/*********************************************************************
 * Data de criacao    : 31/05/2019                                   *
 * Data de modificaco : 00/00/0000                                   *
 *-------------------------------------------------------------------*
 * polNasaH:                                                         *
 *-------------------------------------------------------------------*
 * Parametros de entrada:                                            *
 *-------------------------------------------------------------------*
 * x  -> temperatura                                                 *   
 * R  -> constante dos gases ideias                                  *
 * mW -> massa molar                                                 *
 *-------------------------------------------------------------------*
 * Parametros de saida:                                              *
 *-------------------------------------------------------------------*
 * H em KJ/KMOL                                                      *
 *-------------------------------------------------------------------*
 * OBS:                                                              *
 * nasa7                                                             *
 * H0(T)/RT = a1 ln T + a2T + 0.5a3T^2 + a3/4T^3 - 0.5a5/5T^4 + a7    *
 * nasa9                                                             *
 *-------------------------------------------------------------------*
 *********************************************************************/
DOUBLE polNasaS(PolNasa *a     , DOUBLE const x, bool const fKelvin)
{

  DOUBLE sum,*c=NULL,xi,r,tc;

  if(fKelvin)
    tc = x;  
  else
    tc = CELSIUS_FOR_KELVIN(x);

/*KJ/(Kmol Kelvin) */
  r = 8.3144621;

  nasaPolRange(a,tc,&c,&xi,2);

  if (a->type == 7)
    sum = c[0]*log(xi)           + c[1]*xi
        + 0.5e0*c[2]*xi*xi       + c[3]*xi*xi*xi/3.e0 
        - 0.5e0*c[4]*xi*xi*xi*xi + c[6];

  return r*sum;
}
/********************************************************************/
